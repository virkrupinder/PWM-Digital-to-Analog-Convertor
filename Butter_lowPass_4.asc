Version 4
SHEET 1 2136 1352
WIRE 400 160 400 112
WIRE 1520 160 1520 112
WIRE 400 272 400 240
WIRE 1520 272 1520 240
WIRE 1728 512 256 512
WIRE 176 608 176 512
WIRE 1120 608 256 608
WIRE 80 736 48 736
WIRE 176 736 176 608
WIRE 176 736 160 736
WIRE 272 736 176 736
WIRE 384 736 352 736
WIRE 512 736 384 736
WIRE 608 736 592 736
WIRE 720 736 608 736
WIRE 816 736 784 736
WIRE 912 736 896 736
WIRE 1024 736 912 736
WIRE 1120 736 1120 608
WIRE 1120 736 1088 736
WIRE 1216 736 1200 736
WIRE 1328 736 1216 736
WIRE 1424 736 1392 736
WIRE 1520 736 1504 736
WIRE 1632 736 1520 736
WIRE 1728 736 1728 512
WIRE 1728 736 1696 736
WIRE 48 768 48 736
WIRE 1728 784 1728 736
WIRE 176 800 176 736
WIRE 208 800 176 800
WIRE 608 800 608 736
WIRE 640 800 608 800
WIRE 912 800 912 736
WIRE 944 800 912 800
WIRE 1216 800 1216 736
WIRE 1248 800 1216 800
WIRE 1520 800 1520 736
WIRE 1552 800 1520 800
WIRE 384 816 384 736
WIRE 384 816 272 816
WIRE 816 816 816 736
WIRE 816 816 704 816
WIRE 1120 816 1120 736
WIRE 1120 816 1008 816
WIRE 1424 816 1424 736
WIRE 1424 816 1312 816
WIRE 1728 816 1728 784
WIRE 1728 816 1616 816
WIRE 208 832 176 832
WIRE 640 832 608 832
WIRE 944 832 912 832
WIRE 1248 832 1216 832
WIRE 1552 832 1520 832
WIRE 608 880 608 832
WIRE 912 880 912 832
WIRE 1216 880 1216 832
WIRE 1520 880 1520 832
WIRE 96 896 -304 896
WIRE 176 896 176 832
WIRE 176 944 176 896
WIRE 816 944 816 816
WIRE 816 944 256 944
WIRE -304 992 -304 896
WIRE 176 1040 176 944
WIRE 1424 1040 1424 816
WIRE 1424 1040 256 1040
WIRE -304 1104 -304 1072
WIRE 176 1216 176 1040
FLAG 1520 112 in
FLAG 400 112 H
FLAG 1520 272 0
FLAG 400 272 0
FLAG 672 848 VN
FLAG 672 784 VP
FLAG 608 880 0
FLAG 976 848 VN
FLAG 976 784 VP
FLAG 912 880 0
FLAG 1280 848 VN
FLAG 1280 784 VP
FLAG 1216 880 0
FLAG 1584 848 VN
FLAG 1584 784 VP
FLAG 1520 880 0
FLAG 240 848 VN
FLAG 240 784 VP
FLAG 176 1296 0
FLAG 48 768 0
FLAG 624 1216 VN
FLAG 528 1216 VP
FLAG 528 1296 0
FLAG 624 1296 0
FLAG -304 1104 0
FLAG 1728 784 OUT
SYMBOL voltage 1520 144 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR Value PULSE(0 1 0 1n 1n {TON_PWM} {T_PWM})
SYMATTR InstName V1
SYMBOL bv 400 144 R0
SYMATTR InstName B1
SYMATTR Value V=V(in) Laplace ={b4}/(s**4 + s**3*{A1}+s**2*{A2}+s*{A3}+{A4})
SYMBOL res 608 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 5.97k
SYMBOL cap 784 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1n
SYMBOL res 912 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 12.08k
SYMBOL cap 1088 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL res 1216 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 20.2k
SYMBOL cap 1392 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 1n
SYMBOL res 1520 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 41.2k
SYMBOL cap 1696 720 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL Opamps\\UniversalOpamp2 240 816 R0
SYMATTR InstName U1
SYMATTR Value2 Avol=1Meg GBW=1Meg Slew=10Meg
SYMBOL res 368 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RF1
SYMATTR Value 100k
SYMBOL res 160 1200 R0
SYMATTR InstName RF2
SYMATTR Value 100k
SYMBOL res 272 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RA1
SYMATTR Value 100k
SYMBOL res 272 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RA2
SYMATTR Value 100k
SYMBOL res 176 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RD1
SYMATTR Value 100k
SYMBOL res 272 592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RA3
SYMATTR Value 100k
SYMBOL res 272 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RA4
SYMATTR Value 100k
SYMBOL res 192 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RIN1
SYMATTR Value 100k
SYMBOL voltage 528 1200 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL voltage 624 1200 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value -5
SYMBOL Opamps\\UniversalOpamp2 672 816 R0
SYMATTR InstName U2
SYMATTR Value2 Avol=1Meg GBW=1Meg Slew=10Meg
SYMBOL Opamps\\UniversalOpamp2 976 816 R0
SYMATTR InstName U3
SYMATTR Value2 Avol=1Meg GBW=1Meg Slew=10Meg
SYMBOL Opamps\\UniversalOpamp2 1280 816 R0
SYMATTR InstName U4
SYMATTR Value2 Avol=1Meg GBW=1Meg Slew=10Meg
SYMBOL Opamps\\UniversalOpamp2 1584 816 R0
SYMATTR InstName U5
SYMATTR Value2 Avol=1Meg GBW=1Meg Slew=10Meg
SYMBOL voltage -304 976 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 24 44 Left 2
SYMATTR Value2 AC 1
SYMATTR Value PULSE(0 1 0 1n 1n {TON_PWM} {T_PWM})
SYMATTR InstName V4
TEXT -232 24 Left 2 !.param A1=1.64187544e+05\n.param A2=1.34787749e+10  \n.param A3=6.48186445e+14\n.param A4=1.55854546e+19\n.param b4=1.55854546e+19
TEXT -224 240 Left 2 !;ac dec 20 100 10meg
TEXT -744 32 Left 2 !.param F_clock=16Meg\n.param T_clock=1/{F_clock}\n.param TS_MIN=0.01*{T_clock}\n.param TON_clock=0.5*{T_clock}\n.param F_PWM=63.5k\n.param T_PWM=1/{F_PWM}\n.param TON_PWM=.5*{T_PWM}
TEXT -744 272 Left 2 !.MEAS TRAN ripple PP V(out)  \n.MEAS TRAN  t2 AVG  V(out)
TEXT -736 352 Left 2 !.tran 0 1m .5m
TEXT 496 88 Left 2 ;log (1/(ripple+f_pwm/16meg))/log(2)
